"use strict";const input=document.querySelector(".search__input"),button=document.querySelector(".search__button"),result=document.querySelector(".result__series"),favourite=document.querySelector(".fav__series"),savedFavs=JSON.parse(localStorage.getItem("userFavs"));let listFavourites=[];const saveLS=e=>{localStorage.setItem("userFavs",JSON.stringify(e))},paintFavouritesTitle=e=>{const t=document.createElement("h2");t.classList.add("fav--title");const s=document.createTextNode("Mis series favoritas");t.appendChild(s),favourite.appendChild(t),e.length<1?favourite.remove(t):favourite.appendChild(t)},clearFavourites=()=>{favourite.innerHTML=""},paintFavourites=e=>{favourite.innerHTML="",paintFavouritesTitle(e);const t=document.createElement("ol");t.classList.add("fav--list"),favourite.appendChild(t);for(let s of e){const e=s.img,a=s.name,i=document.createElement("li");i.classList.add("fav--box__serie");const r=document.createElement("h3");r.classList.add("fav--name__serie");const n=document.createElement("img");n.classList.add("fav--img__serie");const o=document.createElement("div");o.classList.add("fav--delete");const c=document.createTextNode(a);n.src=e,t.appendChild(i),i.appendChild(n),i.appendChild(r),i.appendChild(o),r.appendChild(c),o.addEventListener("click",deleteFavourite)}};function deleteFavourite(e){const t=e.currentTarget.parentElement,s=t.querySelector(".fav--img__serie"),a=t.querySelector(".fav--name__serie"),i={img:s.src,name:a.innerHTML};for(let e of listFavourites)e===i&&(listFavourites.splice(e),saveLS(listFavourites),paintFavourites(listFavourites))}const pickAsFavourite=e=>{const t=e.currentTarget;t.classList.toggle("fav__serie");const s=t.querySelector(".img__serie"),a=t.querySelector(".name__serie"),i={img:s.src,name:a.innerHTML};t.classList.contains("fav__serie")&&listFavourites.push(i),saveLS(listFavourites),paintFavourites(listFavourites)},paintSeries=e=>{result.innerHTML="";for(let t=0;t<e.length;t++){const s=e[t].show.name,a=e[t].show.image,i=document.createElement("li");i.classList.add("box__serie");const r=document.createElement("h4");r.classList.add("name__serie");const n=document.createElement("img");n.classList.add("img__serie");const o=document.createTextNode(s);n.src=null===a?"https://via.placeholder.com/210x295/bbbbbb/666666/?text=TV":a.medium||a.original,n.alt=`Cover of the serie ${s}`,result.appendChild(i),i.appendChild(n),i.appendChild(r),r.appendChild(o),i.addEventListener("click",pickAsFavourite)}},fetchSeriesFromAPI=()=>{fetch(`http://api.tvmaze.com/search/shows?q=${input.value}`).then(e=>e.json()).then(e=>{e.length>0?paintSeries(e):result.innerHTML="No se encontraron resultados"}).catch(e=>{result.innerHTML=`Ha ocurrido un error: ${e}`})},enterKey=e=>{13===e.keyCode&&fetchSeriesFromAPI()},clearInput=()=>input.value="",getLS=()=>{null!==savedFavs?(listFavourites=savedFavs,paintFavourites(savedFavs)):listFavourites=[]};null!==savedFavs?(listFavourites=savedFavs,paintFavourites(savedFavs)):listFavourites=[],button.addEventListener("click",fetchSeriesFromAPI),input.addEventListener("keyup",enterKey),input.addEventListener("click",clearInput);